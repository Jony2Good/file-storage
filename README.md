# file-storage
Реализация файлового хранилища в видео REST API на языке программирования PHP. Итоговая работа на учебном курсе в компании "Skillbox". Код проверен с помощью статических анализаторов php-cs-fixer, phpstan, rector, qodana, а также протестирован с помощью программы Postman.

1. Файловая структура проекта:
* app:
    - Controllers -> отвечает за взамиодействие с базой данных, реализуется основная логика приложения;
    - DataBase -> подключение к базе данных MySQL;
    - Router -> логика маршрутизации в проекте;
    - Services -> обслуживание классов в контроллерах (валидация, создание токенов, проверка и т.д.).
* config - содержит и секретную информацию по подключаемому ресурсу к проекту.
* public - входная точка в приложение, а также настройки сервера Apache.
* routes - содержит файл, в котором регистрируются отностительные URL.
* views - электронное письмо.

2. Для запуска проекта предполагается использование сторонних зависимостей, которе подключаются с помощью composer.json, а также импорт базы данных file_storage в PHPMyAdmin.

# 3. Как работает приложение.
# По умолчанию правами администратора обладает пользователь с почтой akk_12@mail.ru и паролем 123

3.1. РЕГИСТРАЦИЯ/АВТОРИЗАЦИЯ/АУТЕНТИФИКАЦИЯ: директория app/Controllers/Auth.php
* При регистрации пользователь отправляет в приложение данные (имя, логин, почта, пароль, проверка пароля). При успешном прохождении проверок данные пользователя записываются в таблицу User.
* После прохождения регистрации пользователю необходимо войти в приложение. Вход осуществлялся по электронной почте и паролю. При этом пользователь получает токен. Токен сохраняется в базу данных и проверяется каждый раз, когда пользователь взамиодействует с различными частями приложения.
* Пользователь может выйти из приложения. Выданный токен и сессия уничтожаются. Производятся изменения в базе данных.
* Реализована функция сброса пароля. И введение нового пароля с внесением соответствующих изменений в базу данных.

3.2. ПОЛУЧЕНИЕ ДАННЫХ О ПОЛЬЗОВАТЕЛЕ: директория app/Controllers/User.php
* В приложении реализована логика, доступ к которой имеет только пользователь с ролью «администратора».
    - Получение списка пользователей;
    - Получение конкретного пользователя;
    - Добавление пользователя;
    - Обновление пользовтаеля;
    - Удаление пользователя.

3.3. РАБОТА С ФАЙЛАМИ: директория app/Controllers/File.php
* В приложении реализована логика работы с файловой системой по схеме - структура каталогов и список файлов хранятся в базе данных. А в файловой системе ОС файлы пользователя сохраняются в директории public/uploads в зашифрованном виде. Работа с файлами осуществляется всеми пользователями приложения. Реализуются следующие операции с файлами и каталогами:
    - Создать директорию;
    - Получить директорию;
    - Переименовать директорию;
    - Удалить директорию;
    -  # Важно! При удалении директории, удаляются и все файлы, которые находятся в ней. Производятся соответствующие изменения в базе данных и в файловой системе ОС.
    - Сохранить файл;
    - Получить список или отдельный файл;
    - Удалить файл;
    - Переимновать файл.
    - * # Важно! Файл возможно сохранить только при наличии в запросе к API имени уже существующей директории. Иначе будет выпадать ошибка. Файл не может существовать в приложении без привязки к конкретной директории.

3.4. ФУНКЦИЯ ПОДЕЛИТЬСЯ ФАЙЛАМИ: директория app/Controllers/File.php
* В приложении реализована возможность предоставления права доступа к файлу другим пользователями системы, а именно:
    - Получить список файлов, к которым предоставлен доступ другим пользователям;
    - Предоставить дотсуп к файлу;
    - Прекратить доступ к файлу.
=======
  - Получение списка пользователей;
  - Получение конкретного пользователя;
  - Добавление пользователя;
  - Обновление пользовтаеля;
  - Удаление пользователя.
  
3.3. РАБОТА С ФАЙЛАМИ: директория app/Controllers/File.php
* В приложении реализована логика работы с файловой системой по схеме - структура каталогов и список файлов хранятся в базе данных. А в файловой системе ОС файлы пользователя сохраняются в директории public/uploads в зашифрованном виде. Работа с файлами осуществляется всеми пользователями приложения. Реализуются следующие операции с файлами и каталогами:
  - Создать директорию;
  - Получить директорию;
  - Переименовать директорию;
  - Удалить директорию;
  -  # Важно! При удалении директории, удаляются и все файлы, которые находятся в ней. Производятся соответствующие изменения в базе данных и в файловой системе ОС.
  - Сохранить файл;
  - Получить список или отдельный файл;
  - Удалить файл;
  - Переимновать файл.
  - * # Важно! Файл возможно сохранить только при наличии в запросе к API имени уже существующей директории. Иначе будет выпадать ошибка. Файл не может существовать в приложении без привязки к конкретной директории. 

3.4. ФУНКЦИЯ ПОДЕЛИТЬСЯ ФАЙЛАМИ: директория app/Controllers/File.php
* В приложении реализована возможность предоставления права доступа к файлу другим пользователями системы, а именно:
  - Получить список файлов, к которым предоставлен доступ другим пользователям;
  - Предоставить дотсуп к файлу;
  - Прекратить доступ к файлу
